# Audits æ™ºèƒ½å›¾æ–‘å®¡æ ¸â€”â€”ä½¿ç”¨ LLMã€ PaddleX å’Œ MinerU æå–PDFåŠå›¾åƒä¸­çš„å­—æ®µ

## é¡¹ç›®ä»‹ç»

åˆ©ç”¨ PaddleOCR å’Œ PaddleSeal ä»¥åŠ MinerU åˆ†åˆ«å¯¹ pdf åŠå›¾åƒå®Œæˆæ–‡æœ¬æå–åŠå°ç« è¯†åˆ«å·¥ä½œæµã€‚å€ŸåŠ© vllm éƒ¨ç½²çš„å¾®è°ƒ QWen-VL å¤šæ¨¡æ€æ¨¡å‹å¯¹æå–çš„å­—æ®µè¿›è¡Œæ¯”å¯¹ï¼Œå¹¶ä»¥ json æ ¼å¼è¾“å‡ºç»“æœï¼ŒåŒæ—¶åˆ©ç”¨ mysql æ•°æ®åº“ä¿å­˜å®¡æ ¸ç»“æœï¼Œé€šè¿‡ flask å¼€å‘äº† api æ¥å£ï¼Œå®ç°ä¸æ”¿åºœç›¸å…³ç³»ç»Ÿçš„æ— ç¼å¯¹æ¥ï¼Œä¸ºæ”¿åºœçš„å›¾æ–‘å®¡æ ¸å·¥ä½œæä¾›æ™ºèƒ½åŒ–çš„è¾…åŠ©å·¥å…·ã€‚

è¯¥æ™ºèƒ½ä½“å¯ç”¨äºå®Œæ•´çš„å¤šæ–‡æ¡£å­—æ®µæå–å·¥ä½œï¼Œå¹¶ä¸”æ”¯æŒå¤šæ¨¡æ€çš„å›¾åƒå’Œæ–‡æœ¬è¯†åˆ«å·¥ä½œæµã€‚

## ç³»ç»Ÿè¦æ±‚

- Python >= 3.10
- è‡³å°‘ä¸€å¼  A800 NVIDIA GPUéƒ¨ç½²LLMå’ŒPaddleX + ä¸€å¼ 4090 NVIDIA GPUéƒ¨ç½²MinerU(é•¿æœŸæ¨ç†ä½¿ç”¨ä¸¤å¼ A100)
- å¤šä¸ªå¯è½¬å‘Postçš„Linuxå†…æ ¸çš„Dockerå®¹å™¨
- CUDA + PyTorch
- èƒ½å¤Ÿä»Huggingfaceä¸Šä¸‹è½½æ¨¡å‹æƒé‡
- ç¨³å®šçš„ç½‘ç»œè¿æ¥
- é«˜è´¨é‡ä»£ç†IPï¼ˆé‡è¦ï¼‰

## ç¯å¢ƒæ­å»º

åˆ‡æ¢å·¥ä½œç›®å½•

```bash
cd envs
```

### VLLM ç¯å¢ƒå®‰è£…

å…·ä½“å®‰è£…æ–‡æ¡£è¯·å‚è€ƒ [install_vllm](docs/install_vllm.md)

```bash
./start_vllm.sh
```

å“åº”åœ°å€ [http://172.16.15.10:30109/v1](http://172.16.15.10:30109/v1)

### PaddleX ç¯å¢ƒå®‰è£…

å…·ä½“å®‰è£…æ–‡æ¡£è¯·å‚è€ƒ [install_paddlex](docs/install_paddlex.md)

```bash
./start_paddlex.sh
```

OCR å“åº”åœ°å€ [http://172.16.15.10:30104/ocr](http://172.16.15.10:30104/ocr)

seal å“åº”åœ°å€ [http://172.16.15.10:30105/seal](http://172.16.15.10:30105/seal)

### MinerU ç¯å¢ƒå®‰è£…

å…·ä½“å®‰è£…æ–‡æ¡£è¯·å‚è€ƒ [install_mineru](docs/install_mineru.md)
```bash
./start_mineru.sh
```

### mysql ç¯å¢ƒå®‰è£…

éœ€è¦ä¿®æ”¹å®‰è£…è„šæœ¬ [start_mysql.sh](envs/start_mysql.sh) ä¸­çš„å‚æ•°ï¼ŒåŒ…æ‹¬å®‰è£…åŒ…è·¯å¾„ç­‰ï¼Œå®‰è£…æ–‡æ¡£è¯·å‚è€ƒ [install_mysql](docs/install_mysql.md) ç„¶åæ‰§è¡Œå®‰è£…å‘½ä»¤

```bash
./start_mysql.sh
```

## ä½¿ç”¨æ–¹æ³•

åˆ‡æ¢å·¥ä½œç›®å½•

```bash
cd services
```

### å¯åŠ¨vllmæœåŠ¡

```bash
./start_vllm32.sh
```

### å¯åŠ¨paddlexæœåŠ¡

```bash
./start_paddlex.sh
```

### å¯åŠ¨apiæœåŠ¡

å…³äºapiæ¥å£çš„å…·ä½“è¯´æ˜è¯·å‚è€ƒ [api](docs/api.md)

```bash
./api.sh
```

api çš„å“åº”åœ°å€ä¸º [http://172.16.15.10:30108/api](http://172.16.15.10:30108/api)

### å¯åŠ¨ç¨‹åº

```bash
cd ../
./run.sh
```

## é¡¹ç›®ç»“æ„
è¯¥æ¡†æ¶åŒ…å«ä»¥ä¸‹æ¨¡å—ï¼š
<details>
  <summary>ğŸ‘‰ ç‚¹å‡»æŸ¥çœ‹</summary>
```
Audits
    â”œâ”€â”€ config/
    â”‚   â”œâ”€â”€ config.yaml                # é…ç½®æ–‡ä»¶ï¼Œå­˜å‚¨è·¯å¾„ã€å‚æ•°ç­‰é…ç½®ä¿¡æ¯
    â”œâ”€â”€ data/
    â”‚   â”œâ”€â”€ data/                      # å­˜æ”¾å¾…å¤„ç†ä½è¯ææ–™ï¼Œä¸»è¦ä¸º PDF å’Œå›¾ç‰‡æ–‡ä»¶
    â”‚   â”œâ”€â”€ output/                    # è¾“å‡ºæ–‡ä»¶å¤¹ï¼Œå­˜æ”¾ OCRã€å°ç« è¯†åˆ«å’Œå®¡æ ¸ç»“æœ
    â”‚   â”‚   â”œâ”€â”€ markdown/              # OCR è½¬æ¢åçš„ Markdown æ–‡ä»¶
    â”‚   â”‚   â”œâ”€â”€ json/                  # OCR æå–çš„ JSON æ–‡ä»¶
    â”‚   â”‚   â””â”€â”€ images/                # OCR æå–çš„å›¾ç‰‡
    â”‚   â””â”€â”€ models/                    # æ¨¡å‹æ–‡ä»¶å¤¹ï¼Œå­˜æ”¾é¢„è®­ç»ƒæ¨¡å‹æƒé‡
    â”œâ”€â”€ database/
    â”‚   â”œâ”€â”€ db_downloader.py           # å•çº¿ç¨‹ä¸‹è½½æ•°æ®ç±»ï¼Œç”¨äºä»å¹³å°ä¸‹è½½PDFå’Œå›¾ç‰‡æ–‡ä»¶
    â”‚   â”œâ”€â”€ db_downloader_mt.py        # å¤šçº¿ç¨‹ä¸‹è½½æ•°æ®ç±»ï¼Œç”¨äºä»å¹³å°ä¸‹è½½PDFå’Œå›¾ç‰‡æ–‡ä»¶
    â”‚   â”œâ”€â”€ audit_results_my.py        # mysql æ•°æ®åº“ç»“æœæ“ä½œç±»ï¼Œç”¨äºå°†æ¨¡å‹è¯†åˆ«çš„å­—å…¸ç»“æœå‚¨å­˜åˆ°æ•°æ®åº“ä¸apiæŸ¥è¯¢ç»“æœ
    â”‚   â”œâ”€â”€ audit_results.py           # æ•°æ®åº“ç»“æœæ“ä½œç±»ï¼Œç”¨äºå°†æ¨¡å‹è¯†åˆ«çš„å­—å…¸ç»“æœå‚¨å­˜åˆ°æ•°æ®åº“ä¸apiæŸ¥è¯¢ç»“æœ
    â”‚   â””â”€â”€ audit_results.db           # æ•°æ®åº“æ–‡ä»¶ï¼Œç”¨äºå­˜å‚¨æ¨¡å‹è¯†åˆ«çš„å­—å…¸ç»“æœ
    â”œâ”€â”€ models/
    â”‚   â”œâ”€â”€ ocr_mineru.py              # OCR å¤„ç†è„šæœ¬ï¼Œè°ƒç”¨ MinerU æ¡†æ¶
    â”‚   â”œâ”€â”€ ocr_paddle.py              # OCR å¤„ç†è„šæœ¬ï¼Œè°ƒç”¨ PaddleOCR æ¡†æ¶
    â”‚   â”œâ”€â”€ seal_recognition.py        # å°ç« è¯†åˆ«è„šæœ¬ï¼Œè°ƒç”¨ PaddleX æ¡†æ¶
    â”‚   â”œâ”€â”€ llm_extraction.py          # LLM å†…å®¹æå–è„šæœ¬ï¼Œè°ƒç”¨ QWQ-32b æ¨¡å‹
    â”‚   â””â”€â”€ vlm_extraction.py          # VLM å†…å®¹æå–è„šæœ¬ï¼Œè°ƒç”¨ QWen-VL-32b æ¨¡å‹
    â”œâ”€â”€ workflow/
    â”‚   â”œâ”€â”€ workflow.py                # å·¥ä½œæµåŸºç±»ï¼Œç”¨äºæ‰§è¡Œæ™ºèƒ½ä½“æ¡†æ¶çš„å„ä¸ªæ­¥éª¤
    â”‚   â”œâ”€â”€ workflow_mini.py           # åªä½¿ç”¨VLMæ¨¡å‹å•æ¡æµ
    â”‚   â”œâ”€â”€ workflow_lite.py           # ä½¿ç”¨VLMå’ŒMinerUå’ŒPaddleXæ–‡æœ¬å¤„ç†åŒå·¥ä½œæµ
    â”‚   â”œâ”€â”€ workflow_ultra.py          # ä½¿ç”¨VLMå’ŒMinerUçš„å¤šæ¨¡æ€å’ŒMinerUæ–‡æœ¬çš„åŒå·¥ä½œæµ
    â”‚   â”œâ”€â”€ workflow_pro.py            # ä½¿ç”¨LLMå’ŒMinerUå’ŒPaddleXçš„å›¾åƒå’Œæ–‡æœ¬åŒå·¥ä½œæµ
    â”‚   â””â”€â”€ workflow_plus.py           # ä½¿ç”¨VLMå’ŒMinerUçš„å¤šæ¨¡æ€å’ŒMinerUæ–‡æœ¬å’ŒPaddleOCRçš„ä¸‰å·¥ä½œæµ
    â”œâ”€â”€ test/
    â”‚   â”œâ”€â”€ db_download_id.py          # å•IDä¸‹è½½æ•°æ®ç±»ï¼Œç”¨äºä»å¹³å°ä¸‹è½½PDFå’Œå›¾ç‰‡æ–‡ä»¶
    â”‚   â””â”€â”€ vlm_extraction.py          # VLM å†…å®¹æå–è„šæœ¬ï¼Œç”¨äºæµ‹è¯•VLMæ¨¡å‹
    â”œâ”€â”€ services/
    â”‚   â”œâ”€â”€ start_llm.sh               # LLM æœåŠ¡å¯åŠ¨è„šæœ¬
    â”‚   â”œâ”€â”€ start_paddlex.sh           # PaddleX æœåŠ¡å¯åŠ¨è„šæœ¬
    â”‚   â”œâ”€â”€ start_vlm.sh               # vLM æœåŠ¡å¯åŠ¨ Qwen-vl-7bæ¨¡å‹è„šæœ¬
    â”‚   â”œâ”€â”€ start_vlm32.sh             # VLM æœåŠ¡å¯åŠ¨ Qwen-vl-32bæ¨¡å‹è„šæœ¬
    â”‚   â””â”€â”€ app.sh                     # Flask æœåŠ¡è„šæœ¬ï¼Œæä¾›æ¥å£ä¸å¹³å°äº¤äº’
    â”œâ”€â”€ api/
    â”‚   â”œâ”€â”€ api.py                     # API è„šæœ¬ï¼Œæä¾›æ¥å£ä¸å¹³å°äº¤äº’
    â”œâ”€â”€ utils/
    â”‚   â””â”€â”€ utils.py                   # å·¥å…·å‡½æ•°
    â”œâ”€â”€ envs/
    â”‚   â”œâ”€â”€ start_vllm.sh              # VLLM ç¯å¢ƒå®‰è£…è„šæœ¬
    â”‚   â”œâ”€â”€ start_paddlex.sh           # PaddleX ç¯å¢ƒå®‰è£…è„šæœ¬
    â”‚   â”œâ”€â”€ start_mineru.sh            # MinerU ç¯å¢ƒå®‰è£…è„šæœ¬
    â”‚   â””â”€â”€ start_mysql.sh             # mysql ç¯å¢ƒå®‰è£…è„šæœ¬
    â”œâ”€â”€ docs/
    â”‚   â”œâ”€â”€ api.md                     # API æ–‡æ¡£
    â”‚   â”œâ”€â”€ issues.md                  # é—®é¢˜åé¦ˆæ–‡æ¡£
    â”‚   â”œâ”€â”€ 
    â”œâ”€â”€ main.py                        # ä¸»ç¨‹åºå…¥å£ï¼Œç”¨äºå¯åŠ¨æœåŠ¡
    â”œâ”€â”€ README.md                      # é¡¹ç›®è¯´æ˜æ–‡æ¡£
    â”‚â”€â”€ requirements.txt               # æœåŠ¡ä¾èµ–æ–‡ä»¶
    â”œâ”€â”€ setup.sh                       # ç¯å¢ƒæ­å»ºè„šæœ¬ï¼Œç”¨äºåˆå§‹åŒ–è™šæ‹Ÿç¯å¢ƒå’Œå®‰è£…ä¾èµ–
    â””â”€â”€ run.sh                         # å¯åŠ¨è„šæœ¬ï¼Œç”¨äºå¯åŠ¨æœåŠ¡
```
</details>

## å¼€å‘è®¡åˆ’
- [ ] æ”¯æŒæ›´å¤šå­—æ®µçš„æå–å®¡æ ¸
- [ ] æ”¯æŒå…¬ç½‘IPæ¥å£
- [ ] æ”¯æŒæ›´å¤šæ¨¡å‹

## è´¡çŒ®
æ¬¢è¿æäº¤é—®é¢˜å’Œä»£ç æ”¹è¿›ã€‚è¯·ç¡®ä¿éµå¾ªé¡¹ç›®çš„ä»£ç é£æ ¼å’Œè´¡çŒ®æŒ‡å—ã€‚

## è®¸å¯è¯
æœ¬é¡¹ç›®é‡‡ç”¨ [GNU è®¸å¯è¯](LICENSE)ã€‚



